     1	      IDENTIFICATION DIVISION.							25NOV25 10:46:01  PAGE	  1
     2	      PROGRAM-ID. ACCOUNT.
     3
     4	      ENVIRONMENT DIVISION.
     5	      CONFIGURATION SECTION.
     6	      SOURCE-COMPUTER. IBM-PC.
     7	      OBJECT-COMPUTER. IBM-PC.
     8
     9	      INPUT-OUTPUT SECTION.
    10	      FILE-CONTROL.
    11            SELECT INFILE ASSIGN TO "TRANSACT.TXT".
    12            SELECT OUTFILE ASSIGN TO "REPORT.TXT".
    13
    14	      DATA DIVISION.
    15	      FILE SECTION.
    16
    17	      FD INFILE
    18		  LABEL RECORD IS STANDARD
    19		  RECORD CONTAINS 43 CHARACTERS
    20		  DATA RECORD IS INREC.
    21
    22	      01 INREC.
    23		  02 ACCT-NO	 PIC X(10).
    24		  02 ACCT-NAME	 PIC X(25).
    25		  02 TRN-CODE	 PIC X.
    26		  02 TRN-AMT	 PIC 9(7)V99.
    27
    28	      FD OUTFILE
    29		  LABEL RECORD IS OMITTED
    30		  DATA RECORD IS OUTREC.
    31
    32	      01 OUTREC.
    33		  02 FILLER PIC X(80).
    34
    35	      WORKING-STORAGE SECTION.
    36
    37	      01 WS-EOF      PIC 9 VALUE 0.
    38	      01 WS-SAVE-ACC PIC X(10) VALUE SPACES.
    39	      01 WS-BAL      PIC S9(9)V99 VALUE 0.
    40	      01 WS-RECS     PIC 9(5) VALUE 0.
    41	      01 WS-TBAL     PIC S9(11)V99 VALUE 0.
    42
    43	      01 HD1.
    44		  02 FILLER PIC X(32) VALUE SPACES.
    45            02 FILLER PIC X(16) VALUE "CHINA TRUST BANK".
    46		  02 FILLER PIC X(32) VALUE SPACES.
    47
    48	      01 HD2.
    49		  02 FILLER PIC X(34) VALUE SPACES.
    50            02 FILLER PIC X(13) VALUE "MAKATI AVENUE".
    51		  02 FILLER PIC X(33) VALUE SPACES.
    52
    53	      01 HD3.
    54		  02 FILLER PIC X(35) VALUE SPACES.
    55            02 FILLER PIC X(11) VALUE "MAKATI CITY".
    56		  02 FILLER PIC X(34) VALUE SPACES.
    57
    58	      01 HD4.
    59		  02 FILLER PIC X(33) VALUE SPACES.
    60            02 FILLER PIC X(14) VALUE "ACCOUNT REPORT".    61		  02 FILLER PIC X(33) VALUE SPACES.					25NOV25 10:46:01  PAGE	  2
    62
    63	      01 HD5.
    64		  02 FILLER PIC X(19) VALUE SPACES.
    65            02 FILLER PIC X(10) VALUE "ACCOUNT NO".
    66		  02 FILLER PIC X(5)  VALUE SPACES.
    67            02 FILLER PIC X(12) VALUE "ACCOUNT NAME".
    68		  02 FILLER PIC X(8)  VALUE SPACES.
    69            02 FILLER PIC X(7)  VALUE "BALANCE".
    70		  02 FILLER PIC X(19) VALUE SPACES.
    71
    72
    73	      01 DETAIL-LINE.
    74		  02 FILLER	PIC X(2) VALUE SPACES.
    75		  02 D-ACCNO	PIC X(10).
    76		  02 FILLER	PIC X(3) VALUE SPACES.
    77		  02 D-ACCNAME	PIC X(25).
    78		  02 FILLER	PIC X(3) VALUE SPACES.
    79		  02 D-BAL	PIC ZZZ,ZZZ,ZZ9.99.
    80		  02 FILLER	PIC X(25) VALUE SPACES.
    81
    82
    83	      01 TOT1.
    84		  02 FILLER PIC X(5) VALUE SPACES.
    85            02 FILLER PIC X(26) VALUE "TOTAL NO. OF RECORDS PRINTED:".
    86		  02 FILLER PIC X(3) VALUE SPACES.
    87		  02 T-RECS PIC 9(5).
    88		  02 FILLER PIC X(31) VALUE SPACES.
    89
    90	      01 TOT2.
    91		  02 FILLER PIC X(5) VALUE SPACES.
    92            02 FILLER PIC X(24) VALUE "TOTAL ACCUMULATED BALANCE:".
    93            02 FILLER PIC X(4) VALUE " P ".
    94		  02 T-TBAL PIC Z,ZZZ,ZZZ,ZZ9.99.
    95		  02 FILLER PIC X(20) VALUE SPACES.
    96
    97	      PROCEDURE DIVISION.
    98
    99	      MAIN-RTN.
   100		  OPEN INPUT INFILE
   101		       OUTPUT OUTFILE.
   102
   103		  READ INFILE AT END
   104		       MOVE 1 TO WS-EOF
   105		  END-READ.
   106
   107		  IF WS-EOF = 1
   108                 DISPLAY "EMPTY FILE"
   109		       CLOSE INFILE OUTFILE
   110		       STOP RUN
   111		  END-IF.
   112
   113		  MOVE ACCT-NO TO WS-SAVE-ACC.
   114
   115		  PERFORM WRITE-HEADERS.
   116
   117		  PERFORM UNTIL WS-EOF = 1
   118		       IF ACCT-NO NOT = WS-SAVE-ACC
   119			    PERFORM ACC-BREAK
   120		       END-IF   121											25NOV25 10:46:01  PAGE	  3
   122		       PERFORM PROCESS-REC
   123
   124		       READ INFILE AT END
   125			    MOVE 1 TO WS-EOF
   126		       END-READ
   127		  END-PERFORM.
   128
   129		  PERFORM ACC-BREAK.
   130		  PERFORM WRITE-TOTALS.
   131
   132		  CLOSE INFILE OUTFILE.
   133		  STOP RUN.
   134
   135	      PROCESS-REC.
   136            IF TRN-CODE = "D"
   137		       ADD TRN-AMT TO WS-BAL
   138		  ELSE
   139		       SUBTRACT TRN-AMT FROM WS-BAL
   140		  END-IF.
   141		  EXIT.
   142
   143	      ACC-BREAK.
   144		  MOVE WS-SAVE-ACC TO D-ACCNO.
   145		  MOVE ACCT-NAME   TO D-ACCNAME.
   146		  MOVE WS-BAL	   TO D-BAL.
   147
   148		  WRITE OUTREC FROM DETAIL-LINE AFTER ADVANCING 1.
   149
   150		  ADD 1 TO WS-RECS.
   151		  ADD WS-BAL TO WS-TBAL.
   152
   153		  MOVE ACCT-NO TO WS-SAVE-ACC.
   154		  MOVE 0 TO WS-BAL.
   155		  EXIT.
   156
   157	      WRITE-HEADERS.
   158		  WRITE OUTREC FROM HD1 AFTER PAGE.
   159		  WRITE OUTREC FROM HD2 AFTER ADVANCING 1.
   160		  WRITE OUTREC FROM HD3 AFTER ADVANCING 1.
   161		  WRITE OUTREC FROM HD4 AFTER ADVANCING 2.
   162		  WRITE OUTREC FROM HD5 AFTER ADVANCING 1.
   163		  EXIT.
   164
   165	      WRITE-TOTALS.
   166		  MOVE WS-RECS TO T-RECS.
   167		  MOVE WS-TBAL TO T-TBAL.
   168
   169		  WRITE OUTREC FROM TOT1 AFTER ADVANCING 3.
   170		  WRITE OUTREC FROM TOT2 AFTER ADVANCING 1.
   171		  EXIT.Realia COBOL Version 4.000   SN: 01-07732  C:ACCOUNT.COB				25NOV25 10:46:01  PAGE	  4

LINE ERR# LVL			 ERROR TEXT

  17 0373 C RECORD CONTAINS clause conflicts with defined record sizes in 'INFILE'
  85 0272 W VALUE too large for item 'FILLER'; accepted
  92 0272 W VALUE too large for item 'FILLER'; accepted
 167 0621 W Digits may be truncated during MOVE from 'WS-TBAL'

account  has   3 Warning  +   1 C Level  messagesRealia COBOL Version 4.000   SN: 01-07732  C:ACCOUNT.COB				25NOV25 10:46:01  PAGE	  5



				    Segment Table
			Segment    Number     Length	    Name

			  C00	     05        03BF	 ACCOUNT$C00
			  D00	     06        0500	 ACCOUNT$D00


			Realia COBOL Compiler Version Information

			      Pass 1	 Version 4.059
			      Pass 1a	 Version 4.025
			      Pass 2	 Version 4.059
			      Pass 2a	 Version 4.024
			      Pass 3	 Version 4.083
			      Pass 4	 Version 4.028


			Compilation Directives in Effect

				    COMP-4
				    NODCHK
				      OPT
				    NOCALL
				    NOSUBCHK
				      STRCHK
				      ANSITRUNC
				    NOSMALLCOMP
				    NODCALL
				    NODIVZERO
				    NOEPDCALL
				      APOST
				      ASCII
				      STATABORT
				      MOVELINK
				    NOBLL4K
				      ARGCHK
				      UPLOW
				      WRITEAFTER
				      SOSI
				      DIALECT-REALIA4

				    ERROR LEVEL LIMIT: W

			Source lines compiled:	     171
			Compilation time (mm:ss.hh):  0:03.74
			Compilation speed (lines/minute):  2743

			Compilation date (yy/mm/dd): 25/11/25
			     Time of day (hh:mm:ss): 10:46:02

			Source length in LST file:000005441